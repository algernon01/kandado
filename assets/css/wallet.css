/* ===== Reset-ish ===== */
*,*::before,*::after{ box-sizing:border-box; }
html, body { overflow-x: hidden; width:100%; }
body { margin: 0; }
img { max-width: 100%; height: auto; display:block; }
code { white-space:normal; overflow-wrap:anywhere; }

/* ===== Vars / Tokens ===== */
:root{
  --primary-700:#334155;
  --muted:#6b7280;
  --border:#e5e7eb;
  --surface-2:#f9fafb;
  --text:#0f172a;
  --brand-1:#3b82f6;
  --brand-2:#6366f1;
  --accent:#a5b4fc;
  --shadow-2:0 1px 2px rgba(0,0,0,.05);
  --active-green-1:#166534;
  --active-green-border:#bbf7d0;
  --active-green-bg:#ecfdf5;
  --header-h:56px;
}

/* ===== Page layout ===== */
.page-wrap{max-width:1200px;margin:0 auto;padding:1rem 1rem 0 1rem;}
.page-head{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:.75rem;margin-bottom:1rem;}
.title-stack h1{font-size:25px;line-height:1.2;margin-bottom:.2rem;color:var(--primary-700); font-weight:800;} 
.title-stack p{color:var(--muted);font-size:.95rem;}
.page-wrap a{ text-decoration:none !important; }

.toolbar{display:flex;flex-wrap:wrap;gap:.5rem;min-width:0;}
.btn{display:inline-flex;align-items:center;gap:.45rem;padding:.58rem .9rem;border-radius:10px;border:1px solid var(--border);background:#fff;cursor:pointer;font-weight:700;}
.btn i{font-size:.95rem;}
.btn:hover{box-shadow:var(--shadow-2);}
.btn.primary{background:linear-gradient(135deg,var(--brand-1),var(--brand-2));color:#fff;border-color:rgba(255,255,255,.25);}
.btn.ghost{background:transparent;}
.btn.small{padding:.42rem .7rem;border-radius:9px;font-weight:600;}

.input,.select{height:40px;border-radius:10px;border:1px solid var(--border);padding:0 .75rem;background:#fff;min-width:0;}
.input:focus,.select:focus{outline:2px solid var(--accent);outline-offset:2px;}

/* Stats */
.stats{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:1rem;margin:1rem 0 1.2rem;}
.stat{background:linear-gradient(180deg,#ffffff, var(--surface-2));border:1px solid var(--border);border-radius:16px;padding:1rem;box-shadow:var(--shadow-2);min-width:0;}
.stat .k{font-size:.8rem;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;margin-bottom:.35rem;}
.stat .v{font-size:1.2rem;font-weight:800;display:flex;align-items:center;gap:.45rem;}
/* FIX: stat numbers no-wrap & tabular digits */
.stat .v .num{white-space:nowrap;font-variant-numeric:tabular-nums;}

/* smaller numbers on narrow phones */
@media (max-width: 420px){
  .stat .v{font-size:1.05rem;}
}

/* Card + table */
.card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:1rem;box-shadow:var(--shadow-2);min-width:0;}
.card h2{font-size:1.05rem;margin-bottom:.75rem;color:var(--text);}
.card .sub{font-size:.88rem;color:var(--muted);margin-bottom:.75rem;}

.table-wrap{overflow-x:auto; overflow-y:hidden; border:1px solid var(--border);border-radius:12px;background:#fff;-webkit-overflow-scrolling:touch;}
.table-wrap::-webkit-scrollbar{height:10px;}
.table-wrap code{font-size:.85rem;}
table{width:100%;border-collapse:separate;border-spacing:0;table-layout:auto;min-width:0;}
thead th{position:sticky;top:0;background:#f8faff;border-bottom:1px solid var(--border);text-align:left;font-size:.85rem;color:var(--muted);padding:.7rem .8rem;z-index:3;}
/* FIX: Actions header centered */
thead th.t-right{ text-align:center; }
tbody td{padding:.75rem .8rem;border-bottom:1px solid var(--border);}
tbody tr:hover{background:#fbfdff;}
.t-num{text-align:right;font-variant-numeric:tabular-nums;}
.chip{display:inline-flex;align-items:center;gap:.4rem;padding:.22rem .55rem;border-radius:999px;font-size:.75rem;font-weight:700;border:1px solid var(--border);background:#f6f8ff;}
.chip.green{background:var(--active-green-bg);border-color:var(--active-green-border);color:var(--active-green-1);}
.chip.gray{background:#eef2ff;border-color:#dfe6ff;color:#374151;}
.chip.red{background:#fee2e2;border-color:#fecaca;color:#991b1b;}
.row-actions{display:flex;gap:.35rem;flex-wrap:wrap; justify-content:center;} /* centered actions */
.muted{color:var(--muted);overflow-wrap:break-word;}
.email{font-size:.9rem;color:#475569;overflow-wrap:anywhere;}
.avatar{width:40px;height:40px;border-radius:50%;object-fit:cover;border:1px solid #e6e9f6;background:#f2f6ff;display:block;}

/* Button action colors (View = soft blue, Top-up = green) */
td.actions-cell .row-actions .btn.small:first-child{
  background:#eef2ff; border-color:#c7d2fe; color:#1d4ed8;
}
td.actions-cell .row-actions .btn.small:last-child{
  background:#ecfdf5; border-color:#bbf7d0; color:#166534;
}

.filters{display:flex;flex-wrap:wrap;gap:.5rem;margin:.4rem 0 .8rem;min-width:0;}
.filters .group{display:flex;gap:.4rem;align-items:center;min-width:0;}
.filters label{font-size:.78rem;color:var(--muted);}
.filters input[type="date"]{height:40px;border-radius:10px;border:1px solid var(--border);padding:0 .5rem;background:#fff;min-width:0;}

.empty{padding:1.2rem;border:1px dashed var(--border);border-radius:12px;background:#fff;color:var(--muted);}
.pager{display:flex;justify-content:space-between;align-items:center;margin-top:.7rem;gap:.6rem;flex-wrap:wrap;}
.pager .pages{font-size:.9rem;color:var(--muted);}
.pager .nav{display:flex;gap:.25rem;align-items:center;flex-wrap:wrap;}
.pager a,.pager span{display:inline-flex;align-items:center;gap:.4rem;padding:.45rem .7rem;border:1px solid var(--border);border-radius:10px;background:#fff;color:#0f172a;font-weight:600;text-decoration:none;}
.pager a.active{background:rgba(34,197,94,.12);border-color:rgba(34,197,94,.35);}
.pager .gap{border:none;background:transparent;padding:.2rem .25rem;color:var(--muted);}
.pager .disabled{opacity:.45;pointer-events:none;}

/* ===== Modals ===== */
.modal{
  position:fixed; inset:0; display:none;
  align-items:flex-end; justify-content:center;
  background:rgba(15,23,42,.38);
  padding:12px;
  z-index:2000;
  overscroll-behavior:contain;           /* <-- fixed */
  -webkit-backdrop-filter:saturate(120%) blur(2px);
  backdrop-filter:saturate(120%) blur(2px);
}
.modal.show{ display:flex; animation:fadeIn .15s ease-out; }
.modal .panel{
  width:100%;
  max-width:min(960px, 100%);
  background:#fff;
  border-radius:16px;
  box-shadow:0 10px 40px rgba(0,0,0,.12);
  transform:translateY(24px);
  opacity:0;
  transition:transform .18s ease, opacity .18s ease;
  display:flex; flex-direction:column;
  max-height:calc(100vh - var(--header-h) - 24px);
}
.modal.show .panel{ transform:translateY(0); opacity:1; }
.modal header{
  position:sticky; top:0; z-index:5;
  display:flex; align-items:center; justify-content:space-between;
  gap:.75rem; padding:.75rem 1rem;
  border-bottom:1px solid var(--border); background:#fff;
  border-top-left-radius:16px; border-top-right-radius:16px;
}
.modal header.scrolled{ box-shadow:0 2px 8px rgba(15,23,42,.06); }
.modal header h3{margin:0;font-size:1.05rem;}
.modal .body{padding:1rem; overflow:auto; -webkit-overflow-scrolling:touch;}
.modal .field{margin-bottom:.8rem;}
.modal .field label{display:block;font-weight:700;margin-bottom:.35rem;color:#374151;}
.modal .actions{display:flex;gap:.5rem;justify-content:flex-end;padding-top:.5rem;}
.quick-amounts{overflow-x:auto;white-space:nowrap;-webkit-overflow-scrolling:touch;}
.quick-amounts .qa{display:inline-block;margin-top:.35rem;}
.modal textarea{width:100%;min-height:72px;resize:vertical;}

/* Bottom sheet for narrow screens */
@media (max-width: 639.98px){
  .modal{ align-items:flex-end; padding-bottom: max(12px, env(safe-area-inset-bottom)); }
  .modal .panel{ max-height:calc(100vh - 12px); border-bottom-left-radius:0; border-bottom-right-radius:0; }
}
/* Center modal for >=640px */
@media (min-width: 640px){
  .modal{ align-items:center; padding-top: calc(var(--header-h) + 16px); }
  .modal .panel{ transform:scale(.98); }
  .modal.show .panel{ transform:scale(1); }
}
@keyframes fadeIn{ from{opacity:.001} to{opacity:1} }
@media (prefers-reduced-motion: reduce){
  .modal .panel{ transition:none; }
  .modal.show{ animation:none; }
}

/* ===== Mobile refinements ===== */
@media (max-width: 1024px){ .stats{grid-template-columns:repeat(2,minmax(0,1fr));} }
@media (max-width: 640px){
  .toolbar{ display:grid; grid-template-columns:1fr 1fr; width:100%; }
  .toolbar > *{ min-width:0; }
  .toolbar .btn{ grid-column:1/-1; }
}
/* Turn all tables into cards on small phones */
@media (max-width: 640px){
  .stats{grid-template-columns:1fr 1fr;}
  .table-wrap{border:0;background:transparent;}
  thead{display:none;}
  tbody{display:block;}
  tbody tr{
    display:block;
    border:1px solid var(--border);
    border-radius:12px;
    background:#fff;
    box-shadow:var(--shadow-2);
    margin-bottom:.75rem;
    overflow:hidden;
  }
  tbody td{
    display:flex;
    align-items:flex-start;
    justify-content:space-between;
    gap:.75rem;
    padding:.65rem .8rem;
    border-bottom:1px solid var(--border);
  }
  tbody tr td:last-child{ border-bottom:0; }
  tbody td::before{
    content:attr(data-th);
    font-weight:700;
    color:var(--muted);
    min-width:5.5rem;
    max-width:45%;
    flex:0 0 auto;
  }
  .t-num{text-align:left;}
  .row-actions{gap:.5rem; justify-content:center;} /* centered on mobile cards */
  .btn.small{padding:.5rem .8rem;}
  .avatar{width:36px;height:36px;}
  td.actions-cell::before{ display:none; }
  td.actions-cell{ padding:.5rem .65rem; }
  td.actions-cell .row-actions{
    display:flex; flex-wrap:nowrap; gap:.4rem;
    overflow-x:auto; -webkit-overflow-scrolling:touch;
    scrollbar-width:none; white-space:nowrap;
  }
  td.actions-cell .row-actions::-webkit-scrollbar{ display:none; }
  td.actions-cell .btn.small{ flex:0 0 auto; padding:.46rem .6rem; font-size:.9rem; }
}
